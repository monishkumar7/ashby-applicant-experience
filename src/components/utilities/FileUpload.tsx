import { useField } from 'formik';

type FileUploadProps = {
  label: string;
  buttonText: string;
  name: string;
  type: string;
};

export default function FileUpload({ label, ...props }: FileUploadProps) {
  const [field, meta, helpers] = useField(props);
  return (
    <div className="flex flex-col space-y-1">
      <p className="text-sm font-semibold text-gray-500">{label}</p>
      {meta.value ? (
        <div className="bg-white flex justify-between px-2 py-1">
          <p className="font-medium flex items-center">
            <svg
              className="inline mr-1"
              width="16"
              height="13"
              viewBox="0 0 16 13"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M3.74226 12.9889C3.00724 12.989 2.30166 12.7001 1.77781 12.1845L1.72004 12.1267C1.45684 11.8699 1.24771 11.563 1.10497 11.2241C0.962232 10.8852 0.888774 10.5211 0.888924 10.1534C0.887994 9.75524 0.966083 9.36089 1.11867 8.99317C1.27125 8.62544 1.49529 8.29165 1.77781 8.01114L8.6667 1.19781C9.36664 0.469041 10.3248 0.0443672 11.3349 0.0152714C12.3449 -0.0138243 13.326 0.354986 14.0667 1.04226C14.4008 1.3755 14.6652 1.7719 14.8445 2.20837C15.0238 2.64483 15.1145 3.11262 15.1111 3.58448C15.1072 4.11146 14.9991 4.63246 14.7932 5.11755C14.5873 5.60265 14.2875 6.04226 13.9111 6.41114L7.72004 12.5445C7.68155 12.5962 7.63226 12.639 7.57558 12.6698C7.5189 12.7006 7.4562 12.7187 7.39182 12.7229C7.32745 12.727 7.26295 12.7171 7.2028 12.6938C7.14265 12.6705 7.08829 12.6343 7.0435 12.5879C6.99871 12.5415 6.96457 12.4859 6.94343 12.4249C6.9223 12.364 6.91469 12.2992 6.92112 12.235C6.92756 12.1708 6.94789 12.1088 6.98071 12.0532C7.01352 11.9977 7.05803 11.95 7.11115 11.9134L13.2845 5.78003C13.5777 5.49384 13.8114 5.15257 13.9724 4.77579C14.1333 4.39901 14.2182 3.99416 14.2223 3.58448C14.2255 3.22992 14.158 2.87828 14.0236 2.55013C13.8893 2.22198 13.6909 1.92392 13.44 1.67337C12.8657 1.1502 12.109 0.873375 11.3327 0.902467C10.5563 0.931558 9.82246 1.26424 9.28892 1.82892L2.42226 8.64225C2.21991 8.83874 2.05871 9.07355 1.94806 9.333C1.83742 9.59244 1.77954 9.87132 1.77781 10.1534C1.77686 10.401 1.82509 10.6464 1.91969 10.8753C2.01429 11.1042 2.15339 11.312 2.32892 11.4867L2.3867 11.5445C2.78437 11.9107 3.30993 12.1061 3.85023 12.0886C4.39054 12.0712 4.90239 11.8422 5.27559 11.4511L11.2089 5.58448C11.3211 5.47103 11.4096 5.33634 11.4691 5.18829C11.5286 5.04024 11.558 4.8818 11.5556 4.72226C11.5566 4.58368 11.53 4.44629 11.4773 4.3181C11.4247 4.18991 11.347 4.07348 11.2489 3.97559C11.0245 3.76977 10.7281 3.66047 10.4238 3.67128C10.1194 3.68209 9.83154 3.81214 9.62226 4.03337L5.53337 8.0867C5.44968 8.1698 5.3364 8.21625 5.21846 8.21584C5.10052 8.21542 4.98758 8.16817 4.90448 8.08448C4.82138 8.00079 4.77493 7.88751 4.77534 7.76957C4.77576 7.65163 4.82301 7.53869 4.9067 7.45559L9.01337 3.38892C9.3898 3.00329 9.90275 2.7811 10.4415 2.77029C10.9803 2.75948 11.5018 2.96092 11.8934 3.33114C12.0735 3.51448 12.215 3.73202 12.3097 3.97094C12.4043 4.20987 12.4502 4.46533 12.4445 4.72226C12.444 4.99893 12.3883 5.27273 12.2807 5.52762C12.1731 5.78252 12.0157 6.01338 11.8178 6.2067L5.90226 12.0911C5.32888 12.6636 4.5525 12.9863 3.74226 12.9889Z"
                fill="#374151"
              />
            </svg>
            {meta.value.split('\\').pop()}
          </p>
          <button
            className="text-red-500 text-sm"
            type="button"
            onClick={() => {
              helpers.setValue(null);
            }}
          >
            Remove File
          </button>
        </div>
      ) : (
        <>
          <label
            className="bg-white text-center text-ashby-700 border-[0.5px] rounded border-ashby-700 px-2 py-1"
            htmlFor={props.name + label}
          >
            {props.buttonText}
          </label>
          <input
            id={props.name + label}
            className="hidden"
            {...field}
            {...props}
          />
        </>
      )}

      {meta.touched && meta.error ? (
        <div className="text-right text-sm text-red-500">{meta.error}</div>
      ) : null}
    </div>
  );
}
